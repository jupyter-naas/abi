@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix skos: <http://www.w3.org/2004/02/skos/core#> .
@prefix dc: <http://purl.org/dc/terms/> .
@prefix bfo: <http://purl.obolibrary.org/obo/> .
@prefix nexus: <http://nexus.platform/ontology/> .


# ======================================================================
# Workspace Member Invitation Process
# BFO 7 Buckets Compliant (ISO 21383-2)
# ======================================================================

nexus:workspace_member_invitation_process a owl:Ontology ;
    dc:title "Workspace Member Invitation Process"@en ;
    dc:description "A process that invites a user to a workspace by email, assigning them a role (admin/member/viewer), requiring the inviter to have admin or owner permissions."@en ;
    dc:created "2026-02-09"^^xsd:date ;
    owl:imports <http://ontology.naas.ai/abi/BFO7Buckets> ,
                <http://nexus.platform/ontology/_shared/common_entities> .


# ======================================================================
# WHAT: Process (BFO_0000015)
# ======================================================================

nexus:WorkspaceMemberInvitationProcess a owl:Class ;
    rdfs:subClassOf bfo:BFO_0000015 ;
    rdfs:label "Workspace Member Invitation Process"@en ;
    skos:definition "A process that invites a user to a workspace by email, assigning them a role (admin/member/viewer), requiring the inviter to have admin or owner permissions."@en ;
    rdfs:comment "Implements: apps/api/app/api/endpoints/workspaces.py:237-279 invite_workspace_member()" ;
    skos:example "1. Check current user role is admin or owner (403 if not)\n2. Query users table for email (404 if not found)\n3. Check if user already a member (400 if duplicate)\n4. Create WorkspaceMemberModel with workspace_id, user_id, role\n5. Insert and commit\n6. Return success with member_id"@en .

# ======================================================================
# WHO: Material Entities (BFO_0000040)
# ======================================================================

nexus:InvitingAdmin a owl:Class ;
    rdfs:subClassOf bfo:BFO_0000040 ;
    rdfs:label "InvitingAdmin"@en ;
    skos:definition "Admin or owner user sending the invitation"@en .

nexus:InvitedUser a owl:Class ;
    rdfs:subClassOf bfo:BFO_0000040 ;
    rdfs:label "InvitedUser"@en ;
    skos:definition "User being added to the workspace (must exist by email)"@en .

# ======================================================================
# WHERE: Sites (BFO_0000029)
# ======================================================================

nexus:InviteEndpoint a owl:Class ;
    rdfs:subClassOf bfo:BFO_0000029 ;
    rdfs:label "InviteEndpoint"@en ;
    skos:definition "API endpoint POST /api/workspaces/{id}/members/invite"@en .

nexus:UsersTable a owl:Class ;
    rdfs:subClassOf bfo:BFO_0000029 ;
    rdfs:label "UsersTable"@en ;
    skos:definition "PostgreSQL users table for email lookup"@en .

nexus:WorkspaceMembersTable a owl:Class ;
    rdfs:subClassOf bfo:BFO_0000029 ;
    rdfs:label "WorkspaceMembersTable"@en ;
    skos:definition "PostgreSQL workspace_members for membership creation"@en .

# ======================================================================
# WHEN: Temporal Regions (BFO_0000008)
# ======================================================================

nexus:InvitationDuration a owl:Class ;
    rdfs:subClassOf bfo:BFO_0000008 ;
    rdfs:label "InvitationDuration"@en ;
    skos:definition "40-80ms: user lookup + member check + insert"@en .

# ======================================================================
# HOW WE KNOW: Information Entities (BFO_0000031)
# ======================================================================

nexus:WorkspaceMemberInvite a owl:Class ;
    rdfs:subClassOf bfo:BFO_0000031 ;
    rdfs:label "WorkspaceMemberInvite"@en ;
    skos:definition "Pydantic model: email (3-255 chars), role (admin|member|viewer, default: member)"@en .

nexus:InvitationResult a owl:Class ;
    rdfs:subClassOf bfo:BFO_0000031 ;
    rdfs:label "InvitationResult"@en ;
    skos:definition "Dict: status=invited, member_id"@en .

# ======================================================================
# HOW IT IS: Qualities (BFO_0000019)
# ======================================================================

nexus:PermissionRequirement a owl:Class ;
    rdfs:subClassOf bfo:BFO_0000019 ;
    rdfs:label "PermissionRequirement"@en ;
    skos:definition "Quality: only admins and owners can invite members"@en .

nexus:UniqueConstraint a owl:Class ;
    rdfs:subClassOf bfo:BFO_0000019 ;
    rdfs:label "UniqueConstraint"@en ;
    skos:definition "Quality: unique(workspace_id, user_id) prevents duplicate memberships"@en .

# ======================================================================
# WHY: Roles (BFO_0000023)
# ======================================================================

nexus:MemberInviterRole a owl:Class ;
    rdfs:subClassOf bfo:BFO_0000023 ;
    rdfs:label "MemberInviterRole"@en ;
    skos:definition "Role realized when admin adds users to workspace"@en .

# ======================================================================
# WHY: Dispositions (BFO_0000016)
# ======================================================================

nexus:EmailLookupDisposition a owl:Class ;
    rdfs:subClassOf bfo:BFO_0000016 ;
    rdfs:label "EmailLookupDisposition"@en ;
    skos:definition "Disposition to find user by email (404 if not registered)"@en .

# ======================================================================
# Process Relationships (BFO Object Properties)
# ======================================================================

nexus:workspace_member_invitation_process_has_invitingadmin a owl:ObjectProperty ;
    rdfs:subPropertyOf bfo:BFO_0000057 ;
    rdfs:domain nexus:WorkspaceMemberInvitationProcess ;
    rdfs:range nexus:InvitingAdmin ;
    rdfs:label "WorkspaceMemberInvitationProcess has participant InvitingAdmin"@en .

nexus:workspace_member_invitation_process_occurs_in a owl:ObjectProperty ;
    rdfs:subPropertyOf bfo:BFO_0000066 ;
    rdfs:domain nexus:WorkspaceMemberInvitationProcess ;
    rdfs:range nexus:InviteEndpoint ;
    rdfs:label "WorkspaceMemberInvitationProcess occurs in InviteEndpoint"@en .

nexus:workspace_member_invitation_process_occupies a owl:ObjectProperty ;
    rdfs:subPropertyOf bfo:BFO_0000199 ;
    rdfs:domain nexus:WorkspaceMemberInvitationProcess ;
    rdfs:range nexus:InvitationDuration ;
    rdfs:label "WorkspaceMemberInvitationProcess occupies InvitationDuration"@en .

nexus:workspace_member_invitation_process_realizes a owl:ObjectProperty ;
    rdfs:subPropertyOf bfo:BFO_0000055 ;
    rdfs:domain nexus:WorkspaceMemberInvitationProcess ;
    rdfs:range nexus:MemberInviterRole ;
    rdfs:label "WorkspaceMemberInvitationProcess realizes MemberInviterRole"@en .

# ======================================================================
# Data Properties
# ======================================================================

nexus:inviteeEmail a owl:DatatypeProperty ;
    rdfs:label "inviteeEmail"@en ;
    rdfs:range xsd:string .

nexus:assignedRole a owl:DatatypeProperty ;
    rdfs:label "assignedRole"@en ;
    rdfs:range xsd:string .
