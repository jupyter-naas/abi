@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix skos: <http://www.w3.org/2004/02/skos/core#> .
@prefix dc: <http://purl.org/dc/terms/> .
@prefix bfo: <http://purl.obolibrary.org/obo/> .
@prefix nexus: <http://nexus.platform/ontology/> .


# ======================================================================
# Graph Workspace Load Process
# BFO 7 Buckets Compliant (ISO 21383-2)
# ======================================================================

nexus:graph_workspace_load_process a owl:Ontology ;
    dc:title "Graph Workspace Load Process"@en ;
    dc:description "A process that loads the complete knowledge graph for a workspace including all nodes and edges, optionally filtered by node type, with configurable limit up to 5000 nodes."@en ;
    dc:created "2026-02-09"^^xsd:date ;
    owl:imports <http://ontology.naas.ai/abi/BFO7Buckets> ,
                <http://nexus.platform/ontology/_shared/common_entities> .


# ======================================================================
# WHAT: Process (BFO_0000015)
# ======================================================================

nexus:GraphWorkspaceLoadProcess a owl:Class ;
    rdfs:subClassOf bfo:BFO_0000015 ;
    rdfs:label "Graph Workspace Load Process"@en ;
    skos:definition "A process that loads the complete knowledge graph for a workspace including all nodes and edges, optionally filtered by node type, with configurable limit up to 5000 nodes."@en ;
    rdfs:comment "Implements: apps/api/app/api/endpoints/graph.py:106-139 get_workspace_graph()" ;
    skos:example "1. Validate workspace access\n2. Query graph_nodes filtered by workspace_id and optional node_type\n3. Apply limit (default 1000, max 5000)\n4. Extract node IDs\n5. Query graph_edges where source and target are in node IDs\n6. Convert ORM models to response schema\n7. Return GraphData with nodes and edges"@en .

# ======================================================================
# WHO: Material Entities (BFO_0000040)
# ======================================================================

nexus:GraphLoader a owl:Class ;
    rdfs:subClassOf bfo:BFO_0000040 ;
    rdfs:label "GraphLoader"@en ;
    skos:definition "Backend logic fetching full workspace graph"@en .

nexus:GraphDatabase a owl:Class ;
    rdfs:subClassOf bfo:BFO_0000040 ;
    rdfs:label "GraphDatabase"@en ;
    skos:definition "PostgreSQL storing nodes and edges"@en .

# ======================================================================
# WHERE: Sites (BFO_0000029)
# ======================================================================

nexus:WorkspaceGraphEndpoint a owl:Class ;
    rdfs:subClassOf bfo:BFO_0000029 ;
    rdfs:label "WorkspaceGraphEndpoint"@en ;
    skos:definition "API endpoint GET /api/graph/workspaces/{workspace_id}"@en .

nexus:GraphNodesTable a owl:Class ;
    rdfs:subClassOf bfo:BFO_0000029 ;
    rdfs:label "GraphNodesTable"@en ;
    skos:definition "PostgreSQL graph_nodes table"@en .

nexus:GraphEdgesTable a owl:Class ;
    rdfs:subClassOf bfo:BFO_0000029 ;
    rdfs:label "GraphEdgesTable"@en ;
    skos:definition "PostgreSQL graph_edges table"@en .

# ======================================================================
# WHEN: Temporal Regions (BFO_0000008)
# ======================================================================

nexus:LoadDuration a owl:Class ;
    rdfs:subClassOf bfo:BFO_0000008 ;
    rdfs:label "LoadDuration"@en ;
    skos:definition "50-500ms depending on graph size"@en .

# ======================================================================
# HOW WE KNOW: Information Entities (BFO_0000031)
# ======================================================================

nexus:GraphData a owl:Class ;
    rdfs:subClassOf bfo:BFO_0000031 ;
    rdfs:label "GraphData"@en ;
    skos:definition "Response: nodes list + edges list"@en .

nexus:NodeTypeFilter a owl:Class ;
    rdfs:subClassOf bfo:BFO_0000031 ;
    rdfs:label "NodeTypeFilter"@en ;
    skos:definition "Optional query param to filter by node type"@en .

nexus:LoadLimit a owl:Class ;
    rdfs:subClassOf bfo:BFO_0000031 ;
    rdfs:label "LoadLimit"@en ;
    skos:definition "Default 1000, max 5000 nodes"@en .

# ======================================================================
# HOW IT IS: Qualities (BFO_0000019)
# ======================================================================

nexus:FilterSupport a owl:Class ;
    rdfs:subClassOf bfo:BFO_0000019 ;
    rdfs:label "FilterSupport"@en ;
    skos:definition "Quality: optional node_type parameter for type-based filtering"@en .

nexus:SizeLimit a owl:Class ;
    rdfs:subClassOf bfo:BFO_0000019 ;
    rdfs:label "SizeLimit"@en ;
    skos:definition "Quality: configurable limit prevents loading excessively large graphs"@en .

# ======================================================================
# WHY: Roles (BFO_0000023)
# ======================================================================

nexus:GraphDataProviderRole a owl:Class ;
    rdfs:subClassOf bfo:BFO_0000023 ;
    rdfs:label "GraphDataProviderRole"@en ;
    skos:definition "Role realized when system provides full graph for visualization"@en .

# ======================================================================
# WHY: Dispositions (BFO_0000016)
# ======================================================================

nexus:LazyEdgeLoadingDisposition a owl:Class ;
    rdfs:subClassOf bfo:BFO_0000016 ;
    rdfs:label "LazyEdgeLoadingDisposition"@en ;
    skos:definition "Disposition to only load edges connecting returned nodes"@en .

# ======================================================================
# Process Relationships (BFO Object Properties)
# ======================================================================

nexus:graph_workspace_load_process_has_graphloader a owl:ObjectProperty ;
    rdfs:subPropertyOf bfo:BFO_0000057 ;
    rdfs:domain nexus:GraphWorkspaceLoadProcess ;
    rdfs:range nexus:GraphLoader ;
    rdfs:label "GraphWorkspaceLoadProcess has participant GraphLoader"@en .

nexus:graph_workspace_load_process_occurs_in a owl:ObjectProperty ;
    rdfs:subPropertyOf bfo:BFO_0000066 ;
    rdfs:domain nexus:GraphWorkspaceLoadProcess ;
    rdfs:range nexus:WorkspaceGraphEndpoint ;
    rdfs:label "GraphWorkspaceLoadProcess occurs in WorkspaceGraphEndpoint"@en .

nexus:graph_workspace_load_process_occupies a owl:ObjectProperty ;
    rdfs:subPropertyOf bfo:BFO_0000199 ;
    rdfs:domain nexus:GraphWorkspaceLoadProcess ;
    rdfs:range nexus:LoadDuration ;
    rdfs:label "GraphWorkspaceLoadProcess occupies LoadDuration"@en .

nexus:graph_workspace_load_process_realizes a owl:ObjectProperty ;
    rdfs:subPropertyOf bfo:BFO_0000055 ;
    rdfs:domain nexus:GraphWorkspaceLoadProcess ;
    rdfs:range nexus:GraphDataProviderRole ;
    rdfs:label "GraphWorkspaceLoadProcess realizes GraphDataProviderRole"@en .

# ======================================================================
# Data Properties
# ======================================================================

nexus:nodeLimit a owl:DatatypeProperty ;
    rdfs:label "nodeLimit"@en ;
    rdfs:range xsd:integer .

nexus:nodeTypeFilter a owl:DatatypeProperty ;
    rdfs:label "nodeTypeFilter"@en ;
    rdfs:range xsd:string .
