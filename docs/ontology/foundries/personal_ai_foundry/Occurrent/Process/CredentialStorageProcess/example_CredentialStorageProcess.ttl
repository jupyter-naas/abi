@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix bfo: <http://purl.obolibrary.org/obo/BFO_> .
@prefix paf: <http://ontology.abi.ai/personal_ai_foundry#> .
@prefix cs: <http://ontology.abi.ai/contact_schema#> .
@prefix skos: <http://www.w3.org/2004/02/skos/core#> .

# Example of a Browser Extension Credential Storage Process

:bankingCredentialStorage a cs:CredentialStorageProcess ;
    rdfs:label "Banking Platform Credential Storage Process"@en ;
    cs:processId "csp-2023-11-05-143022-67890" ;
    cs:initiatedBy :browserExtensionCapture ;
    cs:executedBy :personalAiSystem ;
    cs:timestamp "2023-11-05T14:30:22Z"^^xsd:dateTime ;
    
    # Browser extension that initiated the process
    cs:browserExtensionCapture [
        a paf:BrowserExtension ;
        cs:extensionName "Secure Password Manager Extension" ;
        cs:browserType "Chrome" ;
        cs:captureMethod "form-submission" ;
        cs:domainDetected "wellsfargo.com" ;
        cs:formType "login" ;
        cs:timestamp "2023-11-05T14:30:20Z"^^xsd:dateTime
    ] ;
    
    # Initiation Phase
    cs:initiationPhase [
        a cs:StorageInitiationPhase ;
        cs:timestamp "2023-11-05T14:30:22Z"^^xsd:dateTime ;
        cs:initiationSource "browser-extension" ;
        cs:storageIntent "credential-update" ;
        cs:requestSource :chromeExtension ;
        cs:userPromptShown true ;
        cs:promptText "Would you like to update your Wells Fargo password?" ;
        cs:userResponseReceived "Yes" ;
        cs:promptTimestamp "2023-11-05T14:30:21Z"^^xsd:dateTime
    ] ;
    
    # Determination Phase
    cs:determinationPhase [
        a cs:DeterminationPhase ;
        cs:timestamp "2023-11-05T14:30:23Z"^^xsd:dateTime ;
        cs:isNewCredential false ;
        cs:domainExists true ;
        cs:existingCredentialCount 1 ;
        cs:existingCredentialId "cred-wells-fargo-12345" ;
        cs:passwordChangeDetected true ;
        cs:usernameMatchFound true ;
        cs:lastUpdateTimestamp "2023-08-05T09:15:33Z"^^xsd:dateTime
    ] ;
    
    # Metadata Collection Phase
    cs:metadataCollectionPhase [
        a cs:MetadataCollectionPhase ;
        cs:timestamp "2023-11-05T14:30:24Z"^^xsd:dateTime ;
        cs:platformIdentified true ;
        cs:platform :wellsFargoPlatform ;
        cs:usernameCollected true ;
        cs:usernameVerified true ;
        cs:categoryAssigned true ;
        cs:existingCategoryRetained true ;
        cs:suggestedCategories "financial", "banking" ;
        cs:selectedCategory "financial" ;
        cs:securityTierAssigned "high" ;
        cs:notesAdded false ;
        cs:existingNotesRetained true ;
        cs:urlCaptured "https://connect.secure.wellsfargo.com/auth/login" ;
        cs:faviconCaptured true
    ] ;
    
    # Encryption Phase
    cs:encryptionPhase [
        a cs:EncryptionPhase ;
        cs:timestamp "2023-11-05T14:30:25Z"^^xsd:dateTime ;
        cs:masterKeyAccessed true ;
        cs:masterKeySource "keychain-secure-enclave" ;
        cs:encryptionAlgorithm "AES-256-GCM" ;
        cs:metadataEncrypted true ;
        cs:secretEncrypted true ;
        cs:memoryProtection true ;
        cs:credentialVersioning true ;
        cs:previousVersionRetained true ;
        cs:sensitiveDataRedacted true ;
        cs:encryptionNonceGenerated true
    ] ;
    
    # Storage Phase
    cs:storagePhase [
        a cs:StoragePhase ;
        cs:timestamp "2023-11-05T14:30:26Z"^^xsd:dateTime ;
        cs:vaultAccessInitiated true ;
        cs:vaultWriteAuthorized true ;
        cs:hierarchyPath "/financial/banking" ;
        cs:indexed true ;
        cs:storageSuccessful true ;
        cs:backupTriggered true ;
        cs:historyEntryCreated true ;
        cs:historyNote "Password updated via browser extension" ;
        cs:changeReasonRecorded "Regular password rotation" ;
        cs:storageLocation "local-encrypted-db" ;
        cs:conflictDetected false
    ] ;
    
    # Synchronization Phase
    cs:synchronizationPhase [
        a cs:StorageSynchronizationPhase ;
        cs:timestamp "2023-11-05T14:30:27Z"^^xsd:dateTime ;
        cs:syncRequired true ;
        cs:deviceTargets :userIphone, :userWindows11Laptop ;
        cs:syncMethod "end-to-end-encrypted" ;
        cs:syncInitiated true ;
        cs:syncCompleted true ;
        cs:syncProtocol "https" ;
        cs:syncRetryPolicy "exponential-backoff" ;
        cs:priorityLevel "standard" ;
        cs:changesVersioned true ;
        cs:changeSequenceNumber 42 ;
        cs:deviceLastUpdated [
            cs:device :userIphone ;
            cs:lastUpdateTimestamp "2023-11-05T14:30:35Z"^^xsd:dateTime ;
            cs:updateStatus "successful"
        ], [
            cs:device :userWindows11Laptop ;
            cs:lastUpdateTimestamp "2023-11-05T14:30:42Z"^^xsd:dateTime ;
            cs:updateStatus "successful"
        ]
    ] ;
    
    # Verification Phase
    cs:verificationPhase [
        a cs:StorageVerificationPhase ;
        cs:timestamp "2023-11-05T14:30:43Z"^^xsd:dateTime ;
        cs:integrityVerified true ;
        cs:retrievalTested true ;
        cs:decryptionVerified true ;
        cs:userNotified true ;
        cs:notificationMethod "browser-toast" ;
        cs:notificationMessage "Your Wells Fargo password has been updated successfully" ;
        cs:processStatus "completed" ;
        cs:allDevicesSynced true ;
        cs:verificationChecksums [
            cs:localChecksum "sha256:f58a...e29b" ;
            cs:cloudChecksum "sha256:f58a...e29b" ;
            cs:integritySatisfied true
        ]
    ] ;
    
    # Credential Details
    cs:updatedCredential [
        a cs:StoredCredential ;
        cs:credentialId "cred-wells-fargo-12345" ;
        cs:platform :wellsFargoPlatform ;
        cs:platformName "Wells Fargo" ;
        cs:username "encrypted:AES256:a23f...d98b" ;  # Encrypted username value
        cs:passwordLastModified "2023-11-05"^^xsd:date ;
        cs:passwordChangeFrequency "quarterly" ;
        cs:strengthScore 92 ;
        cs:passwordLength 22 ;
        cs:containsSpecialChars true ;
        cs:containsNumbers true ;
        cs:containsMixedCase true ;
        cs:twoFactorAvailable true ;
        cs:twoFactorEnabled true ;
        cs:twoFactorMethods "authenticator-app", "sms" ;
        cs:preferredTwoFactorMethod "authenticator-app" ;
        cs:lastUsed "2023-11-05T14:30:15Z"^^xsd:dateTime ;
        cs:accessFrequency "weekly" ;
        cs:category "financial" ;
        cs:subcategory "banking" ;
        cs:tags "banking", "bills", "primary-account" ;
        cs:securityTier "high" ;
        cs:securityQuestions 3 ;
        cs:notes "encrypted:AES256:c4d2...e67f" ;  # Encrypted notes
        cs:importance "critical" ;
        cs:recoveryInstructions "Check email or call customer service at 1-800-XXX-XXXX" ;
        cs:breachStatus "not-breached" ;
        cs:breachLastChecked "2023-11-05"^^xsd:date
    ] ;
    
    # Platform Details
    cs:targetPlatform [
        a cs:Platform ;
        cs:platformId "wells-fargo" ;
        cs:platformName "Wells Fargo" ;
        cs:platformType "financial" ;
        cs:platformURL "https://www.wellsfargo.com/" ;
        cs:platformDomain "wellsfargo.com" ;
        cs:mobileAppId "com.wf.wellsfargomobile" ;
        cs:passwordRules [
            cs:minLength 8 ;
            cs:maxLength 32 ;
            cs:requiresSpecialChars true ;
            cs:requiresNumbers true ;
            cs:requiresUppercase true ;
            cs:disallowedChars "&<>\\\"'" ;
            cs:passwordHistoryLimit 5
        ] ;
        cs:authenticationMethods "username-password", "2fa", "biometric" ;
        cs:lockoutPolicy "5-attempts" ;
        cs:sessionTimeout 600 ;  # seconds
        cs:securityRating "high" ;
        cs:breachHistory []  # Empty array indicates no known breaches
    ] ;
    
    # Browser Context
    cs:browserContext [
        a cs:BrowserContext ;
        cs:browserName "Google Chrome" ;
        cs:browserVersion "118.0.5993.117" ;
        cs:operatingSystem "macOS 13.5" ;
        cs:formUrl "https://connect.secure.wellsfargo.com/auth/login" ;
        cs:formTitle "Sign On to View Your Accounts" ;
        cs:userAgent "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.0.0 Safari/537.36" ;
        cs:ipAddress "192.168.1.5" ;
        cs:timezone "America/Los_Angeles" ;
        cs:formElements [
            cs:elementId "username" ;
            cs:elementType "text" ;
            cs:autoFillDetected true
        ], [
            cs:elementId "password" ;
            cs:elementType "password" ;
            cs:autoFillDetected true
        ], [
            cs:elementId "btnSave" ;
            cs:elementType "submit" ;
            cs:clickDetected true
        ]
    ] ;
    
    # Process Metadata
    cs:processDuration 21 ;  # in seconds
    cs:processStatus "completed" ;
    cs:systemComponents :vaultSystem, :encryptionSystem, :syncEngine, :browserIntegration ;
    cs:userDevices :userMacbook, :userIphone, :userWindows11Laptop ;
    cs:aiAssistance [
        a paf:AIAssistanceMetadata ;
        cs:categoryRecognition true ;
        cs:securityTierAssessment true ;
        cs:strengthAnalysis true ;
        cs:userPreferences [
            cs:preferredSyncBehavior "immediate" ;
            cs:preferredNotificationMethod "browser-toast" ;
            cs:preferredPasswordStrength "very-strong" ;
            cs:preferredCategorization "automatic"
        ]
    ] ;
    
    # Strength Assessment
    cs:strengthAssessment [
        a cs:PasswordStrengthAssessment ;
        cs:overallScore 92 ;  # Out of 100
        cs:lengthScore 100 ;  # Out of 100
        cs:complexityScore 95 ;  # Out of 100
        cs:uniquenessScore 85 ;  # Out of 100
        cs:estimatedCrackTime "centuries" ;  # Human-readable estimate
        cs:crackTimeInSeconds "9.45e+21" ;  # Scientific notation
        cs:feedback "Excellent password strength. Consider enabling additional 2FA methods if available." ;
        cs:commonPatterns false ;
        cs:dictionaryWords false ;
        cs:personalInfoDetected false
    ] ;
    
    # Output Metadata
    cs:storageStatus "successful" ;
    cs:credentialId "cred-wells-fargo-12345" ;
    cs:vaultPath "/financial/banking/wells-fargo" ;
    cs:syncStatus [
        cs:completedDevices 2 ;
        cs:pendingDevices 0 ;
        cs:failedDevices 0
    ] ;
    cs:duplicateDetection false ;
    cs:backupStatus "completed" .

# Device Definitions
:userMacbook a cs:UserDevice ;
    rdfs:label "User's MacBook Pro" ;
    cs:deviceId "device-macbook-12345" ;
    cs:deviceType "laptop" ;
    cs:operatingSystem "macOS 13.5" ;
    cs:trusted true ;
    cs:biometricCapabilities "touch-id" ;
    cs:lastSyncTime "2023-11-05T14:30:43Z"^^xsd:dateTime ;
    cs:isCurrentDevice true .

:userIphone a cs:UserDevice ;
    rdfs:label "User's iPhone 14 Pro" ;
    cs:deviceId "device-iphone-67890" ;
    cs:deviceType "smartphone" ;
    cs:operatingSystem "iOS 17.0.3" ;
    cs:trusted true ;
    cs:biometricCapabilities "face-id" ;
    cs:lastSyncTime "2023-11-05T14:30:35Z"^^xsd:dateTime ;
    cs:isCurrentDevice false .

:userWindows11Laptop a cs:UserDevice ;
    rdfs:label "User's Windows Laptop" ;
    cs:deviceId "device-windows-laptop-54321" ;
    cs:deviceType "laptop" ;
    cs:operatingSystem "Windows 11" ;
    cs:trusted true ;
    cs:biometricCapabilities "fingerprint" ;
    cs:lastSyncTime "2023-11-05T14:30:42Z"^^xsd:dateTime ;
    cs:isCurrentDevice false .

# System Components
:vaultSystem a cs:VaultSystem ;
    rdfs:label "Secure Credential Vault" ;
    cs:systemId "vault-system-001" ;
    cs:encryptionType "AES-256" ;
    cs:zeroKnowledgeArchitecture true ;
    cs:cloudBackupEnabled true ;
    cs:backupEncrypted true ;
    cs:versionNumber "3.5.2" ;
    cs:storageEngine "SQLCipher" ;
    cs:backupFrequency "daily" ;
    cs:redundancyLevel "high" .

:encryptionSystem a cs:EncryptionSystem ;
    rdfs:label "Encryption System" ;
    cs:systemId "encryption-system-001" ;
    cs:primaryAlgorithm "AES-256-GCM" ;
    cs:keyDerivationFunction "Argon2id" ;
    cs:memoryHardened true ;
    cs:keyRotationPolicy "annual" ;
    cs:versionNumber "2.3.0" ;
    cs:quantumResistant false .

:syncEngine a cs:SyncEngine ;
    rdfs:label "Synchronization Engine" ;
    cs:systemId "sync-engine-001" ;
    cs:transportSecurity "TLS 1.3" ;
    cs:endToEndEncryption true ;
    cs:conflictResolutionStrategy "last-writer-wins" ;
    cs:offlineCapabilities true ;
    cs:versionNumber "4.1.2" ;
    cs:syncProtocols "https", "websockets" .

:browserIntegration a cs:BrowserIntegration ;
    rdfs:label "Browser Integration System" ;
    cs:systemId "browser-integration-001" ;
    cs:supportedBrowsers "Chrome", "Firefox", "Safari", "Edge" ;
    cs:formDetectionAccuracy 0.98 ;
    cs:fieldMappingCapabilities true ;
    cs:autofillSupported true ;
    cs:versionNumber "3.2.5" ;
    cs:recognitionPatterns 245 .

# Related Events
:credentialUpdateEvent a cs:CredentialUpdatedEvent ;
    cs:eventId "cue-2023-11-05-143043-54321" ;
    cs:timestamp "2023-11-05T14:30:43Z"^^xsd:dateTime ;
    cs:platformId "wells-fargo" ;
    cs:credentialId "cred-wells-fargo-12345" ;
    cs:userId "user-001" ;
    cs:sourceDeviceId "device-macbook-12345" ;
    cs:storageDetails [
        cs:method "browser-extension" ;
        cs:passwordChanged true ;
        cs:usernameChanged false ;
        cs:categoryChanged false ;
        cs:device "MacBook Pro" ;
        cs:location "home" ;
        cs:successful true
    ] ;
    cs:organizationDetails [
        cs:category "financial" ;
        cs:subcategory "banking" ;
        cs:tags "banking", "bills", "primary-account" ;
        cs:autoCategorizationApplied false
    ] ;
    cs:syncDetails [
        cs:syncInitiated true ;
        cs:devicesTargeted 2 ;
        cs:syncCompleted true ;
        cs:syncDuration 16 ;  # seconds
        cs:retryCount 0
    ] ;
    cs:securityDetails [
        cs:passwordStrengthIncreased true ;
        cs:previousStrengthScore 80 ;
        cs:newStrengthScore 92 ;
        cs:breachCheckPerformed true ;
        cs:breachesDetected 0
    ] ;
    cs:processingStats [
        cs:determinationTime 120 ;  # milliseconds
        cs:metadataProcessingTime 185 ;  # milliseconds
        cs:encryptionTime 95 ;  # milliseconds
        cs:storageTime 250 ;  # milliseconds
        cs:syncTime 16000 ;  # milliseconds
        cs:verificationTime 320 ;  # milliseconds
        cs:totalProcessingTime 16970  # milliseconds
    ] . 